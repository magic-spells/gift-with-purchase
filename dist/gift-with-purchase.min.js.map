{"version":3,"file":"gift-with-purchase.min.js","sources":["../src/gift-with-purchase.js"],"sourcesContent":["import \"./gift-with-purchase.scss\";\n\n/**\n * giftwithpurchase main component\n * - automatically adds / removes a gift variant when a cart threshold is met\n * - emits gwp:added / gwp:removed / gwp:error and re-broadcasts cart-dialog:data-changed using the\n *   cart payload returned by shopify so the cart ui can update without an extra fetch\n */\nclass GiftWithPurchase extends HTMLElement {\n  // private fields\n  #threshold = 0;\n  #currentAmount = 0;\n  #variantId = null;\n  #isActive = false;\n  #isAdded = false;\n  #promoEnded = false;\n  #cartPanel = null;\n  #productImage = null;\n  #productTitle = null;\n  #variantTitle = null;\n  #boundHandleCartDataChange = null; // pre-bound listener ref for clean-up\n  #debounceTimer = null; // debouncing cart updates\n  #messageAbove = null; // message when threshold is met\n  #messageBelow = null; // message when below threshold\n\n  /** attributes to observe */\n  static get observedAttributes() {\n    return [\"threshold\", \"current\", \"variant-id\", \"promo-ended\", \"message-above\", \"message-below\"];\n  }\n\n  constructor() {\n    super();\n    // read initial attributes once\n    this.#threshold = parseFloat(this.getAttribute(\"threshold\")) || 0;\n    this.#currentAmount = parseFloat(this.getAttribute(\"current\")) || 0;\n    this.#variantId = this.getAttribute(\"variant-id\");\n    this.#promoEnded = this.hasAttribute(\"promo-ended\");\n    this.#messageAbove = this.getAttribute(\"message-above\");\n    this.#messageBelow = this.getAttribute(\"message-below\");\n    this.#boundHandleCartDataChange = this.#handleCartDataChange.bind(this);\n  }\n\n  connectedCallback() {\n    this.#render();\n    this.#updateState();\n    this.#attachListeners();\n  }\n\n  disconnectedCallback() {\n    if (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n    if (this.#cartPanel)\n      this.#cartPanel.removeEventListener(\n        \"cart-dialog:data-changed\",\n        this.#boundHandleCartDataChange\n      );\n  }\n\n  attributeChangedCallback(name, oldVal, newVal) {\n    if (oldVal === newVal) return;\n    if (name === \"threshold\") this.#threshold = parseFloat(newVal) || 0;\n    else if (name === \"current\") this.#currentAmount = parseFloat(newVal) || 0;\n    else if (name === \"variant-id\") this.#variantId = newVal;\n    else if (name === \"promo-ended\") this.#promoEnded = newVal !== null;\n    else if (name === \"message-above\") this.#messageAbove = newVal;\n    else if (name === \"message-below\") this.#messageBelow = newVal;\n    this.#updateState();\n  }\n\n  #render() {\n    this.#productImage = this.querySelector(\"[data-gwp-image]\");\n    this.#productTitle = this.querySelector(\"[data-gwp-title]\");\n    this.#variantTitle = this.querySelector(\"[data-gwp-variant]\");\n    this.classList.add(\"gift-with-purchase\");\n    this.#renderMessages();\n  }\n\n  #renderMessages() {\n    // create or update message element\n    let messageEl = this.querySelector(\".gwp-message\");\n    if (!messageEl && (this.#messageAbove || this.#messageBelow)) {\n      messageEl = document.createElement(\"div\");\n      messageEl.className = \"gwp-message\";\n      this.appendChild(messageEl);\n    }\n    this.#updateMessages();\n  }\n\n  #updateMessages() {\n    const messageEl = this.querySelector(\".gwp-message\");\n    if (!messageEl) return;\n\n    let message = \"\";\n    if (this.#isActive && this.#messageAbove) {\n      message = this.#messageAbove;\n    } else if (!this.#isActive && this.#messageBelow) {\n      const remaining = this.#threshold - this.#currentAmount;\n      message = this.#messageBelow.replace(\"{{ amount }}\", remaining.toFixed(2));\n    }\n\n    messageEl.textContent = message;\n    messageEl.style.display = message ? \"block\" : \"none\";\n  }\n\n  #attachListeners() {\n    this.#cartPanel = this.closest(\"cart-panel\");\n    if (this.#cartPanel)\n      this.#cartPanel.addEventListener(\n        \"cart-dialog:data-changed\",\n        this.#boundHandleCartDataChange\n      );\n  }\n\n  #handleCartDataChange(event) {\n    const cart = event.detail;\n    if (!cart || typeof cart.total_price === \"undefined\") return;\n    if (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n    this.#debounceTimer = setTimeout(() => {\n      this.#debounceTimer = null;\n      this.setCurrentAmount(cart.total_price / 100);\n      this.#checkGiftInCart(cart);\n    }, 300);\n  }\n\n  #checkGiftInCart(cart) {\n    if (!cart.items || !this.#variantId) {\n      this.#isAdded = false;\n      this.#updateState();\n      return;\n    }\n    const giftLines = cart.items.filter(\n      (lineItem) =>\n        lineItem.variant_id.toString() === this.#variantId.toString() &&\n        lineItem.properties?._gwp_item === \"true\"\n    );\n    this.#isAdded = giftLines.length > 0;\n    if (this.#promoEnded && giftLines.length)\n      this.#removeAllGiftItems(giftLines);\n    this.#updateState();\n  }\n\n  #updateState() {\n    const wasActive = this.#isActive;\n    this.#isActive =\n      this.#currentAmount >= this.#threshold && !this.#promoEnded;\n\n    if (this.#promoEnded) {\n      this.setAttribute(\"data-promo-ended\", \"true\");\n      this.removeAttribute(\"data-active\");\n      this.removeAttribute(\"data-inactive\");\n    } else if (this.#isActive) {\n      this.setAttribute(\"data-active\", \"true\");\n      this.removeAttribute(\"data-inactive\");\n      this.removeAttribute(\"data-promo-ended\");\n    } else {\n      this.setAttribute(\"data-inactive\", \"true\");\n      this.removeAttribute(\"data-active\");\n      this.removeAttribute(\"data-promo-ended\");\n    }\n    this.toggleAttribute(\"data-added\", this.#isAdded);\n\n    if (!this.#promoEnded) {\n      if (this.#isActive && !wasActive && !this.#isAdded && this.#variantId)\n        this.#addGiftToCart();\n      else if (!this.#isActive && wasActive && this.#isAdded && this.#variantId)\n        this.#removeGiftFromCart();\n    }\n    this.#updateVisualState();\n    this.#updateMessages();\n  }\n\n  #updateVisualState() {\n    this.classList.remove(\n      \"gwp-inactive\",\n      \"gwp-active\",\n      \"gwp-added\",\n      \"gwp-ended\"\n    );\n    if (this.#promoEnded) {\n      this.classList.add(\"gwp-ended\");\n      this.style.display = \"none\";\n      return;\n    }\n    this.style.display = \"\";\n    this.classList.add(\n      this.#isAdded\n        ? \"gwp-added\"\n        : this.#isActive\n          ? \"gwp-active\"\n          : \"gwp-inactive\"\n    );\n  }\n\n  /** helper: broadcast updated cart payload to surrounding cart-dialog / components */\n  #broadcastCart(cart) {\n    if (!cart) return;\n    this.dispatchEvent(\n      new CustomEvent(\"cart-dialog:data-changed\", {\n        detail: cart,\n        bubbles: true,\n      })\n    );\n  }\n\n  async #addGiftToCart() {\n    try {\n      const res = await fetch(\"/cart/add.js\", {\n        method: \"POST\",\n        credentials: \"same-origin\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Requested-With\": \"XMLHttpRequest\",\n        },\n        body: JSON.stringify({\n          items: [\n            {\n              id: this.#variantId,\n              quantity: 1,\n              properties: { _gwp_item: \"true\", _hide_in_cart: \"true\" },\n            },\n          ],\n        }),\n      });\n      if (!res.ok) throw new Error(`http ${res.status}`);\n      const updatedCart = await res.json();\n      this.#isAdded = true;\n      this.#updateState();\n      this.#broadcastCart(updatedCart);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:added\", {\n          detail: { variantId: this.#variantId },\n          bubbles: true,\n        })\n      );\n    } catch (err) {\n      console.error(\"giftwithpurchase: add error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"add\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  async #removeGiftFromCart() {\n    try {\n      const cart = await (\n        await fetch(\"/cart.js\", { credentials: \"same-origin\" })\n      ).json();\n      const giftLines = cart.items.filter(\n        (lineItem) =>\n          lineItem.variant_id.toString() === this.#variantId.toString() &&\n          lineItem.properties?._gwp_item === \"true\"\n      );\n      if (!giftLines.length) {\n        this.#isAdded = false;\n        this.#updateState();\n        return;\n      }\n      await this.#removeAllGiftItems(giftLines);\n    } catch (err) {\n      console.error(\"giftwithpurchase: remove error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"remove\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  async #removeAllGiftItems(giftLines) {\n    try {\n      await Promise.all(\n        giftLines.map((giftItem) =>\n          fetch(\"/cart/change.js\", {\n            method: \"POST\",\n            credentials: \"same-origin\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              \"X-Requested-With\": \"XMLHttpRequest\",\n            },\n            body: JSON.stringify({ id: giftItem.key, quantity: 0 }),\n          })\n        )\n      );\n      this.#isAdded = false;\n      this.#updateState();\n      // note: you can broadcast cart again here if you want real-time re-render after remove\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:removed\", {\n          detail: { variantId: this.#variantId },\n          bubbles: true,\n        })\n      );\n    } catch (err) {\n      console.error(\"giftwithpurchase: bulk remove error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"remove\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  // public api helpers\n  setCurrentAmount(amount) {\n    this.#currentAmount = parseFloat(amount) || 0;\n    this.setAttribute(\"current\", this.#currentAmount.toString());\n    this.#updateState();\n  }\n  setThreshold(amount) {\n    this.#threshold = parseFloat(amount) || 0;\n    this.setAttribute(\"threshold\", this.#threshold.toString());\n    this.#updateState();\n  }\n  setVariantId(id) {\n    this.#variantId = id;\n    this.setAttribute(\"variant-id\", id);\n  }\n  setPromoEnded(flag) {\n    this.#promoEnded = !!flag;\n    flag\n      ? this.setAttribute(\"promo-ended\", \"\")\n      : this.removeAttribute(\"promo-ended\");\n    this.#updateState();\n  }\n  getState() {\n    return {\n      currentAmount: this.#currentAmount,\n      threshold: this.#threshold,\n      variantId: this.#variantId,\n      isActive: this.#isActive,\n      isAdded: this.#isAdded,\n      promoEnded: this.#promoEnded,\n      remainingAmount: Math.max(0, this.#threshold - this.#currentAmount),\n    };\n  }\n  updateProduct({ image, title, variantTitle, alt } = {}) {\n    if (image && this.#productImage) {\n      this.#productImage.src = image;\n      if (alt) this.#productImage.alt = alt;\n    }\n    if (title && this.#productTitle) this.#productTitle.textContent = title;\n    if (variantTitle && this.#variantTitle)\n      this.#variantTitle.textContent = variantTitle;\n  }\n  get currentAmount() {\n    return this.#currentAmount;\n  }\n  get threshold() {\n    return this.#threshold;\n  }\n  get variantId() {\n    return this.#variantId;\n  }\n  get isActive() {\n    return this.#isActive;\n  }\n  get isAdded() {\n    return this.#isAdded;\n  }\n  get promoEnded() {\n    return this.#promoEnded;\n  }\n}\n\nif (!customElements.get(\"gift-with-purchase\")) {\n  customElements.define(\"gift-with-purchase\", GiftWithPurchase);\n}\n\nexport { GiftWithPurchase };\n"],"names":["GiftWithPurchase","HTMLElement","threshold","currentAmount","variantId","isActive","isAdded","promoEnded","cartPanel","productImage","productTitle","variantTitle","boundHandleCartDataChange","debounceTimer","messageAbove","messageBelow","observedAttributes","constructor","super","this","parseFloat","getAttribute","hasAttribute","handleCartDataChange","bind","connectedCallback","render","updateState","attachListeners","disconnectedCallback","clearTimeout","removeEventListener","attributeChangedCallback","name","oldVal","newVal","querySelector","classList","add","renderMessages","messageEl","document","createElement","className","appendChild","updateMessages","message","remaining","replace","toFixed","textContent","style","display","closest","addEventListener","event","cart","detail","total_price","setTimeout","setCurrentAmount","checkGiftInCart","items","giftLines","filter","lineItem","variant_id","toString","properties","_gwp_item","length","removeAllGiftItems","wasActive","setAttribute","removeAttribute","toggleAttribute","addGiftToCart","removeGiftFromCart","updateVisualState","remove","broadcastCart","dispatchEvent","CustomEvent","bubbles","res","fetch","method","credentials","headers","body","JSON","stringify","id","quantity","_hide_in_cart","ok","Error","status","updatedCart","json","err","console","error","action","Promise","all","map","giftItem","key","amount","setThreshold","setVariantId","setPromoEnded","flag","getState","remainingAmount","Math","max","updateProduct","image","title","alt","src","customElements","get","define"],"mappings":"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"}