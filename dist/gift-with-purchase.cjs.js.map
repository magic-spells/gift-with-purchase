{"version":3,"file":"gift-with-purchase.cjs.js","sources":["../src/gift-with-purchase.js"],"sourcesContent":["import \"./gift-with-purchase.scss\";\n\n/**\n * giftwithpurchase main component\n * - automatically adds / removes a gift variant when a cart threshold is met\n * - emits gwp:added / gwp:removed / gwp:error and re-broadcasts cart-dialog:data-changed using the\n *   cart payload returned by shopify so the cart ui can update without an extra fetch\n */\nclass GiftWithPurchase extends HTMLElement {\n  // private fields\n  #threshold = 0;\n  #currentAmount = 0;\n  #variantId = null;\n  #isActive = false;\n  #isAdded = false;\n  #promoEnded = false;\n  #cartPanel = null;\n  #productImage = null;\n  #productTitle = null;\n  #variantTitle = null;\n  #boundHandleCartDataChange = null; // pre-bound listener ref for clean-up\n  #debounceTimer = null; // debouncing cart updates\n  #messageAbove = null; // message when threshold is met\n  #messageBelow = null; // message when below threshold\n\n  /** attributes to observe */\n  static get observedAttributes() {\n    return [\"threshold\", \"current\", \"variant-id\", \"promo-ended\", \"message-above\", \"message-below\"];\n  }\n\n  constructor() {\n    super();\n    // read initial attributes once\n    this.#threshold = parseFloat(this.getAttribute(\"threshold\")) || 0;\n    this.#currentAmount = parseFloat(this.getAttribute(\"current\")) || 0;\n    this.#variantId = this.getAttribute(\"variant-id\");\n    this.#promoEnded = this.hasAttribute(\"promo-ended\");\n    this.#messageAbove = this.getAttribute(\"message-above\");\n    this.#messageBelow = this.getAttribute(\"message-below\");\n    this.#boundHandleCartDataChange = this.#handleCartDataChange.bind(this);\n  }\n\n  connectedCallback() {\n    this.#render();\n    this.#updateState();\n    this.#attachListeners();\n  }\n\n  disconnectedCallback() {\n    if (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n    if (this.#cartPanel)\n      this.#cartPanel.removeEventListener(\n        \"cart-dialog:data-changed\",\n        this.#boundHandleCartDataChange\n      );\n  }\n\n  attributeChangedCallback(name, oldVal, newVal) {\n    if (oldVal === newVal) return;\n    if (name === \"threshold\") this.#threshold = parseFloat(newVal) || 0;\n    else if (name === \"current\") this.#currentAmount = parseFloat(newVal) || 0;\n    else if (name === \"variant-id\") this.#variantId = newVal;\n    else if (name === \"promo-ended\") this.#promoEnded = newVal !== null;\n    else if (name === \"message-above\") this.#messageAbove = newVal;\n    else if (name === \"message-below\") this.#messageBelow = newVal;\n    this.#updateState();\n  }\n\n  #render() {\n    this.#productImage = this.querySelector(\"[data-gwp-image]\");\n    this.#productTitle = this.querySelector(\"[data-gwp-title]\");\n    this.#variantTitle = this.querySelector(\"[data-gwp-variant]\");\n    this.classList.add(\"gift-with-purchase\");\n    this.#renderMessages();\n  }\n\n  #renderMessages() {\n    // create or update message element\n    let messageEl = this.querySelector(\".gwp-message\");\n    if (!messageEl && (this.#messageAbove || this.#messageBelow)) {\n      messageEl = document.createElement(\"div\");\n      messageEl.className = \"gwp-message\";\n      this.appendChild(messageEl);\n    }\n    this.#updateMessages();\n  }\n\n  #updateMessages() {\n    const messageEl = this.querySelector(\".gwp-message\");\n    if (!messageEl) return;\n\n    let message = \"\";\n    if (this.#isActive && this.#messageAbove) {\n      message = this.#messageAbove;\n    } else if (!this.#isActive && this.#messageBelow) {\n      const remaining = this.#threshold - this.#currentAmount;\n      message = this.#messageBelow.replace(\"{{ amount }}\", remaining.toFixed(2));\n    }\n\n    messageEl.textContent = message;\n    messageEl.style.display = message ? \"block\" : \"none\";\n  }\n\n  #attachListeners() {\n    this.#cartPanel = this.closest(\"cart-panel\");\n    if (this.#cartPanel)\n      this.#cartPanel.addEventListener(\n        \"cart-dialog:data-changed\",\n        this.#boundHandleCartDataChange\n      );\n  }\n\n  #handleCartDataChange(event) {\n    const cart = event.detail;\n    if (!cart || typeof cart.total_price === \"undefined\") return;\n    if (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n    this.#debounceTimer = setTimeout(() => {\n      this.#debounceTimer = null;\n      this.setCurrentAmount(cart.total_price / 100);\n      this.#checkGiftInCart(cart);\n    }, 300);\n  }\n\n  #checkGiftInCart(cart) {\n    if (!cart.items || !this.#variantId) {\n      this.#isAdded = false;\n      this.#updateState();\n      return;\n    }\n    const giftLines = cart.items.filter(\n      (lineItem) =>\n        lineItem.variant_id.toString() === this.#variantId.toString() &&\n        lineItem.properties?._gwp_item === \"true\"\n    );\n    this.#isAdded = giftLines.length > 0;\n    if (this.#promoEnded && giftLines.length)\n      this.#removeAllGiftItems(giftLines);\n    this.#updateState();\n  }\n\n  #updateState() {\n    const wasActive = this.#isActive;\n    this.#isActive =\n      this.#currentAmount >= this.#threshold && !this.#promoEnded;\n\n    if (this.#promoEnded) {\n      this.setAttribute(\"data-promo-ended\", \"true\");\n      this.removeAttribute(\"data-active\");\n      this.removeAttribute(\"data-inactive\");\n    } else if (this.#isActive) {\n      this.setAttribute(\"data-active\", \"true\");\n      this.removeAttribute(\"data-inactive\");\n      this.removeAttribute(\"data-promo-ended\");\n    } else {\n      this.setAttribute(\"data-inactive\", \"true\");\n      this.removeAttribute(\"data-active\");\n      this.removeAttribute(\"data-promo-ended\");\n    }\n    this.toggleAttribute(\"data-added\", this.#isAdded);\n\n    if (!this.#promoEnded) {\n      if (this.#isActive && !wasActive && !this.#isAdded && this.#variantId)\n        this.#addGiftToCart();\n      else if (!this.#isActive && wasActive && this.#isAdded && this.#variantId)\n        this.#removeGiftFromCart();\n    }\n    this.#updateVisualState();\n    this.#updateMessages();\n  }\n\n  #updateVisualState() {\n    this.classList.remove(\n      \"gwp-inactive\",\n      \"gwp-active\",\n      \"gwp-added\",\n      \"gwp-ended\"\n    );\n    if (this.#promoEnded) {\n      this.classList.add(\"gwp-ended\");\n      this.style.display = \"none\";\n      return;\n    }\n    this.style.display = \"\";\n    this.classList.add(\n      this.#isAdded\n        ? \"gwp-added\"\n        : this.#isActive\n          ? \"gwp-active\"\n          : \"gwp-inactive\"\n    );\n  }\n\n  /** helper: broadcast updated cart payload to surrounding cart-dialog / components */\n  #broadcastCart(cart) {\n    if (!cart) return;\n    this.dispatchEvent(\n      new CustomEvent(\"cart-dialog:data-changed\", {\n        detail: cart,\n        bubbles: true,\n      })\n    );\n  }\n\n  async #addGiftToCart() {\n    try {\n      const res = await fetch(\"/cart/add.js\", {\n        method: \"POST\",\n        credentials: \"same-origin\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Requested-With\": \"XMLHttpRequest\",\n        },\n        body: JSON.stringify({\n          items: [\n            {\n              id: this.#variantId,\n              quantity: 1,\n              properties: { _gwp_item: \"true\", _hide_in_cart: \"true\" },\n            },\n          ],\n        }),\n      });\n      if (!res.ok) throw new Error(`http ${res.status}`);\n      const updatedCart = await res.json();\n      this.#isAdded = true;\n      this.#updateState();\n      this.#broadcastCart(updatedCart);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:added\", {\n          detail: { variantId: this.#variantId },\n          bubbles: true,\n        })\n      );\n    } catch (err) {\n      console.error(\"giftwithpurchase: add error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"add\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  async #removeGiftFromCart() {\n    try {\n      const cart = await (\n        await fetch(\"/cart.js\", { credentials: \"same-origin\" })\n      ).json();\n      const giftLines = cart.items.filter(\n        (lineItem) =>\n          lineItem.variant_id.toString() === this.#variantId.toString() &&\n          lineItem.properties?._gwp_item === \"true\"\n      );\n      if (!giftLines.length) {\n        this.#isAdded = false;\n        this.#updateState();\n        return;\n      }\n      await this.#removeAllGiftItems(giftLines);\n    } catch (err) {\n      console.error(\"giftwithpurchase: remove error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"remove\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  async #removeAllGiftItems(giftLines) {\n    try {\n      await Promise.all(\n        giftLines.map((giftItem) =>\n          fetch(\"/cart/change.js\", {\n            method: \"POST\",\n            credentials: \"same-origin\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              \"X-Requested-With\": \"XMLHttpRequest\",\n            },\n            body: JSON.stringify({ id: giftItem.key, quantity: 0 }),\n          })\n        )\n      );\n      this.#isAdded = false;\n      this.#updateState();\n      // note: you can broadcast cart again here if you want real-time re-render after remove\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:removed\", {\n          detail: { variantId: this.#variantId },\n          bubbles: true,\n        })\n      );\n    } catch (err) {\n      console.error(\"giftwithpurchase: bulk remove error\", err);\n      this.dispatchEvent(\n        new CustomEvent(\"gwp:error\", {\n          detail: { action: \"remove\", error: err.message },\n          bubbles: true,\n        })\n      );\n    }\n  }\n\n  // public api helpers\n  setCurrentAmount(amount) {\n    this.#currentAmount = parseFloat(amount) || 0;\n    this.setAttribute(\"current\", this.#currentAmount.toString());\n    this.#updateState();\n  }\n  setThreshold(amount) {\n    this.#threshold = parseFloat(amount) || 0;\n    this.setAttribute(\"threshold\", this.#threshold.toString());\n    this.#updateState();\n  }\n  setVariantId(id) {\n    this.#variantId = id;\n    this.setAttribute(\"variant-id\", id);\n  }\n  setPromoEnded(flag) {\n    this.#promoEnded = !!flag;\n    flag\n      ? this.setAttribute(\"promo-ended\", \"\")\n      : this.removeAttribute(\"promo-ended\");\n    this.#updateState();\n  }\n  getState() {\n    return {\n      currentAmount: this.#currentAmount,\n      threshold: this.#threshold,\n      variantId: this.#variantId,\n      isActive: this.#isActive,\n      isAdded: this.#isAdded,\n      promoEnded: this.#promoEnded,\n      remainingAmount: Math.max(0, this.#threshold - this.#currentAmount),\n    };\n  }\n  updateProduct({ image, title, variantTitle, alt } = {}) {\n    if (image && this.#productImage) {\n      this.#productImage.src = image;\n      if (alt) this.#productImage.alt = alt;\n    }\n    if (title && this.#productTitle) this.#productTitle.textContent = title;\n    if (variantTitle && this.#variantTitle)\n      this.#variantTitle.textContent = variantTitle;\n  }\n  get currentAmount() {\n    return this.#currentAmount;\n  }\n  get threshold() {\n    return this.#threshold;\n  }\n  get variantId() {\n    return this.#variantId;\n  }\n  get isActive() {\n    return this.#isActive;\n  }\n  get isAdded() {\n    return this.#isAdded;\n  }\n  get promoEnded() {\n    return this.#promoEnded;\n  }\n}\n\nif (!customElements.get(\"gift-with-purchase\")) {\n  customElements.define(\"gift-with-purchase\", GiftWithPurchase);\n}\n\nexport { GiftWithPurchase };\n"],"names":[],"mappings":"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"}