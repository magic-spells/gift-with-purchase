{"version":3,"file":"gift-with-purchase.esm.js","sources":["../src/gift-with-purchase.js"],"sourcesContent":["import './gift-with-purchase.scss';\n\n/**\n * Gift With Purchase Component - automatically adds/removes gift when cart threshold is met\n * Emits gwp:added/gwp:removed/gwp:error events and broadcasts cart updates\n */\nclass GiftWithPurchase extends HTMLElement {\n\t// private fields\n\t#threshold = 0;\n\t#currentAmount = 0;\n\t#variantId = null;\n\t#isActive = false;\n\t#isAdded = false;\n\t#promoEnded = false;\n\t#cartDialog = null;\n\t#boundHandleCartDataChange = null; // pre-bound listener ref for clean-up\n\t#debounceTimer = null; // debouncing cart updates\n\t#messageAbove = null; // message when threshold is met\n\t#messageBelow = null; // message when below threshold\n\n\tstatic get observedAttributes() {\n\t\treturn ['threshold', 'current', 'variant-id', 'promo-ended', 'message-above', 'message-below'];\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\t\t// read initial attributes once\n\t\tthis.#threshold = parseFloat(this.getAttribute('threshold')) || 0;\n\t\tthis.#currentAmount = parseFloat(this.getAttribute('current')) || 0;\n\t\tthis.#variantId = this.getAttribute('variant-id');\n\t\tthis.#promoEnded = this.hasAttribute('promo-ended');\n\t\tthis.#messageAbove = this.getAttribute('message-above');\n\t\tthis.#messageBelow = this.getAttribute('message-below');\n\t\tthis.#boundHandleCartDataChange = this.#handleCartDataChange.bind(this);\n\t}\n\n\tconnectedCallback() {\n\t\tthis.#render();\n\t\tthis.#attachListeners();\n\t}\n\n\tdisconnectedCallback() {\n\t\tif (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n\t\tif (this.#cartDialog)\n\t\t\tthis.#cartDialog.removeEventListener(\n\t\t\t\t'cart-dialog:data-changed',\n\t\t\t\tthis.#boundHandleCartDataChange\n\t\t\t);\n\t}\n\n\t#render() {\n\t\tthis.classList.add('gift-with-purchase');\n\t\tthis.#renderMessages();\n\t}\n\n\t#renderMessages() {\n\t\t// Look for existing message element with data-content-gwp-message\n\t\tthis.#updateMessages();\n\t}\n\n\t#updateMessages() {\n\t\tconst messageEl = this.querySelector('[data-content-gwp-message]');\n\t\tif (!messageEl) return;\n\n\t\tlet message = '';\n\n\t\t// console.log('updateMessages - this.#isActive', this.#isActive);\n\n\t\tif (this.#isActive && this.#messageAbove) {\n\t\t\t// set message to above threshold message\n\t\t\tmessage = this.#messageAbove;\n\t\t} else if (!this.#isActive && this.#messageBelow) {\n\t\t\t// set message to below threshold message\n\t\t\tconst remaining = this.#threshold - this.#currentAmount;\n\t\t\tconst formattedAmount = remaining.toFixed(2).replace(/\\.00$/, '');\n\t\t\tmessage = this.#messageBelow\n\t\t\t\t.replace(/\\{\\s*amount\\s*\\}/g, formattedAmount)\n\t\t\t\t.replace(/\\{amount\\}/g, formattedAmount);\n\t\t}\n\n\t\tmessageEl.textContent = message;\n\t\tmessageEl.style.display = message ? 'block' : 'none';\n\t}\n\n\t#attachListeners() {\n\t\t// Look for cart-dialog element when attaching listeners (more reliable timing)\n\t\tthis.#cartDialog = this.closest('cart-dialog');\n\n\t\tif (this.#cartDialog) {\n\t\t\t// console.log('cartDialog exists and is attaching events');\n\t\t\tthis.#cartDialog.addEventListener(\n\t\t\t\t'cart-dialog:data-changed',\n\t\t\t\tthis.#boundHandleCartDataChange\n\t\t\t);\n\t\t} else {\n\t\t\t// Try again after a short delay in case the DOM isn't fully ready\n\t\t\tsetTimeout(() => {\n\t\t\t\t// console.log('cartDialog DIDNT exist and we waited to attach events');\n\t\t\t\tthis.#cartDialog = this.closest('cart-dialog');\n\t\t\t\tif (this.#cartDialog) {\n\t\t\t\t\tthis.#cartDialog.addEventListener(\n\t\t\t\t\t\t'cart-dialog:data-changed',\n\t\t\t\t\t\tthis.#boundHandleCartDataChange\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error('GWP - cart-dialog still not found after delay');\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\t#handleCartDataChange(event) {\n\t\tconst cart = event.detail;\n\t\t// console.log('GWP - handleCartDataChange cart: ', cart.calculated_subtotal, cart);\n\n\t\tif (!cart || typeof cart.calculated_subtotal === 'undefined') return;\n\t\tif (this.#debounceTimer) clearTimeout(this.#debounceTimer);\n\n\t\tthis.#debounceTimer = setTimeout(() => {\n\t\t\tthis.#debounceTimer = null;\n\t\t\tthis.#currentAmount = parseFloat(cart.calculated_subtotal / 100) || 0;\n\t\t\tthis.#checkGiftInCart(cart);\n\t\t\tthis.#updateState(cart);\n\t\t}, 300);\n\t}\n\n\t// checks to see if the gift is already in the cart\n\t#checkGiftInCart(cart) {\n\t\tif (!cart.items || !this.#variantId) {\n\t\t\tthis.#isAdded = false;\n\t\t\treturn;\n\t\t}\n\t\tconst giftLines = cart.items.filter(\n\t\t\t(lineItem) =>\n\t\t\t\tlineItem.variant_id.toString() === this.#variantId.toString() &&\n\t\t\t\tlineItem.properties?._gwp_item === 'true'\n\t\t);\n\t\tthis.#isAdded = giftLines.length > 0;\n\t\tif (this.#promoEnded && giftLines.length) this.#removeAllGiftItems(giftLines);\n\t}\n\n\t#updateState(cart) {\n\t\t// console.log('********** ----------   Updating state....');\n\t\tconst wasActive = this.#isActive;\n\t\tthis.#isActive = this.#currentAmount >= this.#threshold && !this.#promoEnded;\n\n\t\t// console.log('********** ----------   this.#isActive', this.#isActive);\n\n\t\tif (this.#promoEnded) {\n\t\t\t// remove GWP from cart\n\t\t\tthis.#removeGiftFromCart(cart);\n\t\t}\n\n\t\tif (this.#isActive && !wasActive && !this.#isAdded && this.#variantId) {\n\t\t\tthis.#addGiftToCart();\n\t\t} else if (!this.#isActive && wasActive && this.#isAdded && this.#variantId) {\n\t\t\tthis.#removeGiftFromCart(cart);\n\t\t}\n\n\t\tthis.#updateVisualState();\n\t\tthis.#updateMessages();\n\t}\n\n\t#updateVisualState() {\n\t\tif (this.#promoEnded) {\n\t\t\tthis.setAttribute('state', 'ended');\n\t\t\tthis.style.display = 'none';\n\t\t\treturn;\n\t\t}\n\n\t\tthis.style.display = '';\n\t\tif (this.#isAdded) {\n\t\t\tthis.setAttribute('state', 'added');\n\t\t} else if (this.#isActive) {\n\t\t\tthis.setAttribute('state', 'active');\n\t\t}\n\t\t// Note: no 'inactive' state since component wouldn't be loaded if inactive\n\t}\n\n\tasync #addGiftToCart() {\n\t\ttry {\n\t\t\tconst res = await fetch('/cart/add.js', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcredentials: 'same-origin',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: this.#variantId,\n\t\t\t\t\t\t\tquantity: 1,\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t_gwp_item: 'true',\n\t\t\t\t\t\t\t\t_hide_in_cart: 'true',\n\t\t\t\t\t\t\t\t_ignore_price_in_subtotal: 'true',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t});\n\t\t\tif (!res.ok) throw new Error(`http ${res.status}`);\n\t\t\tawait res.json();\n\t\t\tthis.#isAdded = true;\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew CustomEvent('gwp:added', {\n\t\t\t\t\tdetail: { variantId: this.#variantId },\n\t\t\t\t\tbubbles: true,\n\t\t\t\t})\n\t\t\t);\n\t\t} catch (err) {\n\t\t\tconsole.error('giftwithpurchase: add error', err);\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew CustomEvent('gwp:error', {\n\t\t\t\t\tdetail: { action: 'add', error: err.message },\n\t\t\t\t\tbubbles: true,\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tasync #removeGiftFromCart(cart) {\n\t\ttry {\n\t\t\t// get all GWP items in the cart\n\t\t\tconst giftLines = cart.items.filter(\n\t\t\t\t(lineItem) =>\n\t\t\t\t\tlineItem.variant_id.toString() === this.#variantId.toString() &&\n\t\t\t\t\tlineItem.properties?._gwp_item === 'true'\n\t\t\t);\n\n\t\t\t// exit if no items in the cart\n\t\t\tif (!giftLines.length) {\n\t\t\t\tthis.#isAdded = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// remove all GWP items from the cart\n\t\t\tawait this.#removeAllGiftItems(giftLines);\n\t\t} catch (err) {\n\t\t\tconsole.error('giftwithpurchase: remove error', err);\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew CustomEvent('gwp:error', {\n\t\t\t\t\tdetail: { action: 'remove', error: err.message },\n\t\t\t\t\tbubbles: true,\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tasync #removeAllGiftItems(giftLines) {\n\t\ttry {\n\t\t\tawait Promise.all(\n\t\t\t\tgiftLines.map((giftItem) =>\n\t\t\t\t\tfetch('/cart/change.js', {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tcredentials: 'same-origin',\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: JSON.stringify({ id: giftItem.key, quantity: 0 }),\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\t\t\tthis.#isAdded = false;\n\t\t\t// note: you can broadcast cart again here if you want real-time re-render after remove\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew CustomEvent('gwp:removed', {\n\t\t\t\t\tdetail: { variantId: this.#variantId },\n\t\t\t\t\tbubbles: true,\n\t\t\t\t})\n\t\t\t);\n\t\t} catch (err) {\n\t\t\tconsole.error('giftwithpurchase: bulk remove error', err);\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew CustomEvent('gwp:error', {\n\t\t\t\t\tdetail: { action: 'remove', error: err.message },\n\t\t\t\t\tbubbles: true,\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tgetState() {\n\t\treturn {\n\t\t\tcurrentAmount: this.#currentAmount,\n\t\t\tthreshold: this.#threshold,\n\t\t\tvariantId: this.#variantId,\n\t\t\tisActive: this.#isActive,\n\t\t\tisAdded: this.#isAdded,\n\t\t\tpromoEnded: this.#promoEnded,\n\t\t\tremainingAmount: Math.max(0, this.#threshold - this.#currentAmount),\n\t\t};\n\t}\n\n\tget currentAmount() {\n\t\treturn this.#currentAmount;\n\t}\n\tget threshold() {\n\t\treturn this.#threshold;\n\t}\n\tget variantId() {\n\t\treturn this.#variantId;\n\t}\n\tget isActive() {\n\t\treturn this.#isActive;\n\t}\n\tget isAdded() {\n\t\treturn this.#isAdded;\n\t}\n\tget promoEnded() {\n\t\treturn this.#promoEnded;\n\t}\n\n\t// Public setter methods for programmatic control\n\tsetCurrentAmount(amount) {\n\t\tthis.#currentAmount = parseFloat(amount) || 0;\n\t\tthis.#updateState({ items: [] }); // Pass empty cart to avoid cart operations\n\t\tthis.#updateMessages();\n\t}\n\n\tsetThreshold(threshold) {\n\t\tthis.#threshold = parseFloat(threshold) || 0;\n\t\tthis.#updateState({ items: [] }); // Pass empty cart to avoid cart operations\n\t\tthis.#updateMessages();\n\t}\n\n\tsetVariantId(variantId) {\n\t\tthis.#variantId = variantId;\n\t}\n}\n\nif (!customElements.get('gift-with-purchase')) {\n\tcustomElements.define('gift-with-purchase', GiftWithPurchase);\n}\n\nexport { GiftWithPurchase };\n"],"names":[],"mappings":"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"}